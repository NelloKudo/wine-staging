From dc6b1e2572c7210ece06a3a9665738d3f811b4ba Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Thu, 18 Jul 2024 14:17:44 +1000
Subject: [PATCH 02/15] odbc32: SQLSetEnvAttr isnt supported in ODBC v2.0

---
 dlls/odbc32/proxyodbc.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/dlls/odbc32/proxyodbc.c b/dlls/odbc32/proxyodbc.c
index 2a38197b243..741555f6582 100644
--- a/dlls/odbc32/proxyodbc.c
+++ b/dlls/odbc32/proxyodbc.c
@@ -839,7 +839,7 @@ static int has_suffix( const WCHAR *str, const WCHAR *suffix )
 
 static SQLRETURN set_env_attr( struct handle *handle, SQLINTEGER attr, SQLPOINTER value, SQLINTEGER len )
 {
-    SQLRETURN ret = SQL_ERROR;
+    SQLRETURN ret = SQL_SUCCESS;
 
     if (handle->unix_handle)
     {
@@ -848,7 +848,8 @@ static SQLRETURN set_env_attr( struct handle *handle, SQLINTEGER attr, SQLPOINTE
     }
     else if (handle->win32_handle)
     {
-        ret = handle->win32_funcs->SQLSetEnvAttr( handle->win32_handle, attr, value, len );
+        if (handle->win32_funcs->SQLSetEnvAttr)
+            ret = handle->win32_funcs->SQLSetEnvAttr( handle->win32_handle, attr, value, len );
     }
     return ret;
 }
-- 
2.43.0

